<div class="row-fluid">
    <div class="span8" data-ng-switch="" data-on="isEdit">
        <div data-ng-switch-default="false">
            <h1>{{template.name}}
                <button class="btn-link btn-small" data-ng-click="switchMode()">edit</button></h1>
            <p>{{template.description}}</p>
        </div>
        <div data-ng-switch-when="true">
            <label>Template Name:</label>
            <input class="input-xxlarge" type="text" data-ng-model="template.name" />
            <button class="btn-link" data-ng-click="switchMode()">close</button>
            <label>Template Description:</label>
            <textarea class="input-xxlarge" data-ng-model="template.description" rows="4"></textarea>
        </div>
    </div>
    <div class="span4">
        <button class="btn btn-success" data-ng-click="saveChanges()">Save Template Changes</button>
        <button class="btn" data-ng-click="goBack()">Cancel</button>
    </div>
</div>
<div class="row-fluid">
    <div class="span8">
        <p>
            <strong>Template applies to:</strong>
        </p>
        <ul class="inline">
            <li data-ng-repeat="assignable in templateAppliesTo">
                <div class="btn-group">
                    <button class="btn btn-success">{{assignable.name}}</button>
                    <button class="btn" data-ng-click="removeTemplateAssignable($index)"><i class="icon-remove"></i></button>
                </div>
            </li>
            <li class="dropdown">
                <a class="btn dropdown-toggle" data-toggle="dropdown">Add Value <i class="icon-plus"></i></a>
                <ul class="dropdown-menu">
                    <li>
                        <ul class="collapsible" data-title="{{category}}" data-ng-repeat="category in templateAssignables.categories">
                            <li data-ng-repeat="assignable in templateAssignables.group[category] | searchFilter:'name':query ">
                                <a href="" data-ng-click="setTemplateAssignable(assignable)">{{ assignable.name }}</a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </li>
        </ul>
    </div>
</div>
<ul class="nav nav-tabs">
    <li class="active"><a href="#tasks" data-toggle="tab"><i class="icon-tasks"></i>Tasks</a></li>
    <li><a href="#activity" data-toggle="tab"><i class="icon-bullhorn"></i>Activity</a></li>
</ul>
<div class="tab-content allow-overflow">
    <div class="tab-pane active" id="tasks">
        <div class="row-fluid">
            <div class="span8">
                <div data-ng-repeat="category in categories">
                    <h4>{{ category.name }} <span class="text-info">({{ (template.tasks | taskInCategoryFilter:category.id).length }})</span></h4>
                    <ul class="unstyled">
                        <template-task task="task"
                            assignables="assignables"
                            milestones="milestones"
                            delete-fn="deleteTask(task,isNew)"
                            data-ng-repeat="task in template.tasks | taskInCategoryFilter:category.id | taskFilter:filter" />
                    </ul>
                    <ul class="unstyled">
                        <template-task task="task"
                            available="availableTasks.group[category.id]"
                            assignables="assignables"
                            milestones="milestones"
                            save-fn="saveTask(task)"
                            delete-fn="deleteTask(task,isNew)"
                            data-ng-repeat="task in newTasks[category.id]" />
                    </ul>
                    <p>
                        <button class="btn"
                            data-ng-click="addNewTask(category.id)"
                            data-ng-show="newTasks[category.id].length == 0"
                            data-ng-disabled="isAddingTask">
                            Add New Task <i class="icon-plus"></i>
                        </button>
                    </p>
                </div>
            </div>
            <div class="span4">
                <div class="control-group">
                    <div class="btn-group">
                        <a class="btn dropdown-toggle" data-toggle="dropdown">Show Tasks by Assigned <i class="caret"></i></a>
                        <ul class="dropdown-menu">
                            <li data-complex-menu>
                                <checkbox-filter list="assignees" filter="filter.assignees" value="name" />
                            </li>
                        </ul>
                    </div>
                </div>
                <!--<div class="control-group">
                    <div class="btn-group">
                        <a class="btn dropdown-toggle" data-toggle="dropdown">View Tasks Due <i class="caret"></i></a>
                        <ul class="dropdown-menu">
                            <li data-complex-menu>
                                <radio-filter list="periods" filter="filter.period" value="func" />
                            </li>
                        </ul>
                    </div>
                </div>-->
            </div>
        </div>
    </div>
    <div class="tab-pane" id="activity">
        <ul class="unstyled">
            <li class="muted" data-ng-repeat="item in template.activity">{{item.date | date:'MM/dd/yy'}} {{item.name}}</li>
        </ul>
    </div>
</div>
